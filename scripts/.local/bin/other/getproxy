#!/bin/bash
# test a URL; if it's blocked, print 'proxychains -q'.
# requires rkill(pslist).
trap 'rkill $$' USR1
trap 'echo proxychains -q; rkill $$' USR2
trap exit INT TERM
exec 2>/dev/null
(timeout 8                 curl -fsIL -- "${1:?}" >/dev/null && kill -USR1 $$) &
(timeout 16 proxychains -q curl -fsIL -- "${1:?}" >/dev/null && kill -USR2 $$) &
wait
