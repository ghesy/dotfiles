#!/bin/sh

echo 

pidof -q NetworkManager || exit

conns="$(nmcli -t -f type,device conn show --active)"
type="$(echo "$conns" | head -n1 | cut -d: -f1)"
dev="$(echo "$conns"  | head -n1 | cut -d: -f2)"

[ -z "$conns" ] && echo  && exit

is_usb()
{
    nmcli -t -f general.udi dev show $dev | grep -q '\<usb'
}

is_metered()
{
    nmcli -t -f general.metered dev show $dev | grep -q yes
}

case $type in
    *wireless*|*wifi*) echo 直;;
    *bluetooth*) echo  ;;
    *ethernet*)
        is_usb && echo 禍 || {
            [ "$(echo "$conns" | wc -l)" -gt 1 ] && echo 
        }
    ;;
    *) echo "$conns" | grep -v tun | grep -qv vpn && echo ? || echo  ;;
esac

is_metered && echo ﰒ
! nmcli net conn | grep -q full && echo x && exit
echo "$conns" | cut -d: -f1 | grep -qE 'tun|vpn' && echo  && exit
echo 
