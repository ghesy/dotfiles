#!/bin/sh
# change pulseaudio's sound card profiles via dmenu.
card=$(pactl list short cards | cut -f2 | dmenu -p 'Choose a sound card') || exit
profile=$(
    pacmd list-cards | fgrep -A99 "${card:?}" | grep -A99 profiles | tac |
        grep -A99 'active profile' | sed 1d | tac | sed 1d | cut -d'	' -f3- |
        sed -e 's/\s*(prio.*//' -e 's/^/	/' -e 's/\(\s\+\S\+\): \(.*\)/\2\1/' |
        column -s'	' -t | ifne dmenu -l 10 | rev | cut -d' ' -f1 | rev
)
pacmd set-card-profile "${card:?}" "${profile:?}" &&
    notify-send 'Card profile changed successfully.' ||
    notify-send 'Failed changing the card profile.'
