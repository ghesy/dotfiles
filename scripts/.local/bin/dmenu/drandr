#!/bin/sh
# a simple dmenu interface for xrandr.
# requires xrandr and dmenu.

# dmenu's embedding arg
w=${WINDOWID:+-w $WINDOWID}

# ask which monitor to connect
mon=$(xrandr | grep ' connected' | grep -v primary | cut -d' ' -f1)
[ -z "$mon" ] && { notify-send drandr 'no other monitors detected.'; exit ;}
[ $(echo "$mon" | wc -l) -gt 1 ] && { mon=$(echo "$mon" | dmenu $w -p 'Choose a Display') || exit ;}

# ask type
type=$(printf 'regular\nprimary\noff\n' | dmenu $w -p "Choose $mon's Type") || exit
case $type in
    regular) type='' ;;
    off) xrandr --output "${mon:?}" --off; exit ;;
esac

# ask position
pos=$(printf 'same-as\nright-of\nleft-of\nabove\nbelow\n' | dmenu $w -p "Choose $mon's Position") || exit
rel=$(xrandr | grep ' connected' | cut -d' ' -f1 | grep -Fwv "$mon")
[ $(echo "$rel" | wc -l) -gt 1 ] && { rel=$(echo "$rel" | dmenu $w -p "Put $mon $pos which monitor?") || exit ;}

# apply the selected settings
xrandr --output "${mon:?}" --auto ${type:+--"$type"} ${rel:+--"$pos" "$rel"} || exit
