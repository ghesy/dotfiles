#!/bin/sh
# a simple dmenu interface for the windscribe vpn.

locations='best
crumpets
custard
ranch
seine
castle
canal'

wind() {
    windscribe "$@" | stdbuf -o0 tr -d '\b/|\\-' |
        stdbuf -o0 egrep -v 'symlink|changed' |
        xargs -d'\n' -L1 notify-send -u low -h string:x-canonical-private-synchronous:dvpn Windscribe
}

case $(printf 'Connect\nDisconnect' | dmenu -p VPN) in
    Con*)
        location=$(echo "$locations" | dmenu -p Location)
        [ ${location:?} = best ] && location=
        wind connect $location
    ;;
    Dis*) wind disconnect ;;
esac
