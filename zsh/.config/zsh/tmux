# vim:ft=zsh

_rand()  { tr -dc 'a-zA-Z0-9' </dev/urandom | fold -w10 | head -n1 }
_tkill() { tmux kill-session -t $1 \; killw -t $2 }

_tstart()
{
    _tsesh=$(_rand)
    _twndw=$(_rand)
    trap "_tkill $_tsesh $_twndw" EXIT
    if [ "$(tmux ls 2>/dev/null | wc -l)" -lt 1 ]; then
        tmux new -s $_tsesh -t main \; renamew $_twndw
    else
        tmux new -s $_tsesh -t main \; neww -n $_twndw
    fi
}

[ -z "$TMUX" ] && _tstart
